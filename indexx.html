<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Bot Telegram</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
            padding-bottom: 80px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .header h1 {
            color: #667eea;
            margin-bottom: 5px;
            font-size: 26px;
        }
        
        .header .user-info {
            color: #666;
            font-size: 13px;
            margin-top: 8px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        
        .tab {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            color: #666;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }
        
        .card h2 {
            color: #333;
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card p {
            color: #666;
            font-size: 13px;
            margin-bottom: 12px;
            line-height: 1.5;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            margin-bottom: 8px;
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            box-shadow: 0 4px 15px rgba(245, 87, 108, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            color: white;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-group label {
            display: block;
            color: #333;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .input-group input, .input-group textarea, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .input-group input:focus, .input-group textarea:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .input-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .alert {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 13px;
            color: #856404;
        }
        
        .alert-success {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        
        .alert-danger {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        
        .user-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .user-info-item {
            flex: 1;
        }
        
        .user-name {
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        .user-id {
            color: #666;
            font-size: 12px;
        }
        
        .user-actions {
            display: flex;
            gap: 5px;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            width: auto;
            margin: 0;
        }
        
        .ip-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .ip-info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .ip-info-row:last-child {
            border-bottom: none;
        }
        
        .ip-label {
            font-weight: 600;
            color: #666;
            font-size: 13px;
        }
        
        .ip-value {
            color: #333;
            font-size: 13px;
            text-align: right;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            text-align: center;
            font-size: 12px;
            color: #666;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è Panel Administration</h1>
            <div class="user-info" id="userInfo">Chargement...</div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('dashboard')">üìä Dashboard</button>
            <button class="tab" onclick="switchTab('users')">üë• Utilisateurs</button>
            <button class="tab" onclick="switchTab('broadcast')">üì¢ Broadcast</button>
            <button class="tab" onclick="switchTab('iptracker')">üîç IP Tracker</button>
            <button class="tab" onclick="switchTab('tools')">üõ†Ô∏è Outils</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalUsers">0</div>
                    <div class="stat-label">Utilisateurs</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="verifiedUsers">0</div>
                    <div class="stat-label">V√©rifi√©s</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="bannedUsers">0</div>
                    <div class="stat-label">Bannis</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="activeUsers">0</div>
                    <div class="stat-label">Actifs 24h</div>
                </div>
            </div>

            <div class="card">
                <h2>‚ö° Actions Rapides</h2>
                <button class="btn" onclick="sendQuickBroadcast()">üì§ Broadcast Rapide</button>
                <button class="btn btn-success" onclick="generateInviteLink()">üîó G√©n√©rer un Lien</button>
                <button class="btn btn-secondary" onclick="exportUsers()">üì• Exporter Utilisateurs</button>
            </div>

            <div class="card">
                <h2>üåê Votre Appareil</h2>
                <div class="ip-info" id="deviceInfo">
                    <div class="loading">
                        <div class="spinner"></div>
                        D√©tection en cours...
                    </div>
                </div>
            </div>
        </div>

        <!-- Users Tab -->
        <div id="users" class="tab-content">
            <div class="card">
                <h2>üîç Rechercher un Utilisateur</h2>
                <div class="input-group">
                    <input type="text" id="searchUser" placeholder="ID ou @username">
                </div>
                <button class="btn" onclick="searchUser()">Rechercher</button>
            </div>

            <div class="card">
                <h2>üë• Liste des Utilisateurs</h2>
                <div id="usersList">
                    <div class="loading">Chargement des utilisateurs...</div>
                </div>
            </div>
        </div>

        <!-- Broadcast Tab -->
        <div id="broadcast" class="tab-content">
            <div class="alert">
                ‚ö†Ô∏è Le message sera envoy√© √† tous les utilisateurs actifs
            </div>

            <div class="card">
                <h2>üì¢ Nouveau Broadcast</h2>
                <div class="input-group">
                    <label>Message</label>
                    <textarea id="broadcastMessage" placeholder="Entrez votre message ici..."></textarea>
                </div>
                <div class="input-group">
                    <label>Type</label>
                    <select id="broadcastType">
                        <option value="text">üìù Texte seul</option>
                        <option value="withimage">üñºÔ∏è Avec image</option>
                        <option value="urgent">‚ö†Ô∏è Message urgent</option>
                    </select>
                </div>
                <button class="btn btn-warning" onclick="previewBroadcast()">üëÅÔ∏è Pr√©visualiser</button>
                <button class="btn" onclick="confirmBroadcast()">üì§ Envoyer</button>
            </div>
        </div>

        <!-- IP Tracker Tab -->
        <div id="iptracker" class="tab-content">
            <div class="alert">
                ‚ö†Ô∏è <strong>Rappel l√©gal :</strong> Informez toujours l'utilisateur de la collecte d'IP
            </div>

            <div class="card">
                <h2>üîç Votre IP Actuelle</h2>
                <div class="ip-info" id="myIpInfo">
                    <div class="loading">
                        <div class="spinner"></div>
                        R√©cup√©ration de votre IP...
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>üåê G√©n√©rer un Lien de Tracking</h2>
                <p>Utilisez ces services avec transparence</p>
                <button class="btn" onclick="openGrabify()">üåê Ouvrir Grabify</button>
                <button class="btn btn-secondary" onclick="openIPLogger()">üìä Ouvrir IPLogger</button>
                <button class="btn btn-success" onclick="openIPify()">üîç Ouvrir IPify</button>
            </div>

            <div class="card">
                <h2>üìã Template de Message L√©gal</h2>
                <textarea readonly style="font-size: 12px; background: #f8f9fa;">üîê V√©rification de s√©curit√©

Cliquez sur ce lien pour v√©rifier votre compte :
[VOTRE_LIEN_ICI]

‚ö†Ô∏è IMPORTANT : Ce lien collecte votre adresse IP pour des raisons de s√©curit√© et de pr√©vention de fraude.

En cliquant, vous acceptez la collecte de :
‚Ä¢ Adresse IP
‚Ä¢ Localisation approximative
‚Ä¢ Type d'appareil</textarea>
                <button class="btn btn-success" onclick="copyTemplate()" style="margin-top: 10px;">üìã Copier le Template</button>
            </div>
        </div>

        <!-- Tools Tab -->
        <div id="tools" class="tab-content">
            <div class="card">
                <h2>üî® Outils d'Administration</h2>
                <button class="btn" onclick="banUser()">üö´ Bannir un Utilisateur</button>
                <button class="btn btn-success" onclick="unbanUser()">‚úÖ D√©bannir un Utilisateur</button>
                <button class="btn btn-secondary" onclick="viewInfo()">‚ÑπÔ∏è Info Utilisateur</button>
            </div>

            <div class="card">
                <h2>üìä Statistiques Avanc√©es</h2>
                <button class="btn" onclick="viewStats()">üìà Voir les Stats Compl√®tes</button>
                <button class="btn btn-warning" onclick="clearCache()">üóëÔ∏è Vider le Cache</button>
            </div>

            <div class="card">
                <h2>‚öôÔ∏è Param√®tres</h2>
                <button class="btn btn-secondary" onclick="openBotSettings()">ü§ñ Param√®tres du Bot</button>
                <button class="btn" onclick="reloadData()">üîÑ Recharger les Donn√©es</button>
            </div>
        </div>
    </div>

    <div class="footer">
        D√©velopp√© avec ‚ù§Ô∏è pour Telegram ‚Ä¢ ¬© 2026
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        // R√©cup√©rer les infos utilisateur Telegram
        const user = tg.initDataUnsafe.user;
        if (user) {
            document.getElementById('userInfo').textContent = 
                `Admin: ${user.first_name} (@${user.username || 'N/A'}) ‚Ä¢ ID: ${user.id}`;
        }

        // Fonction pour changer d'onglet
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // D√©tecter les informations de l'appareil avec User Agent
        function detectDevice() {
            const ua = navigator.userAgent;
            let deviceType = 'Inconnu';
            let os = 'Inconnu';
            let browser = 'Inconnu';

            // D√©tecter l'OS
            if (ua.indexOf('Windows') > -1) os = 'Windows';
            else if (ua.indexOf('Mac') > -1) os = 'macOS';
            else if (ua.indexOf('Linux') > -1) os = 'Linux';
            else if (ua.indexOf('Android') > -1) os = 'Android';
            else if (ua.indexOf('iOS') > -1 || ua.indexOf('iPhone') > -1) os = 'iOS';

            // D√©tecter le type d'appareil
            if (ua.indexOf('Mobile') > -1) deviceType = 'üì± Mobile';
            else if (ua.indexOf('Tablet') > -1) deviceType = 'üì± Tablette';
            else deviceType = 'üíª Desktop';

            // D√©tecter le navigateur
            if (ua.indexOf('Chrome') > -1) browser = 'Chrome';
            else if (ua.indexOf('Safari') > -1) browser = 'Safari';
            else if (ua.indexOf('Firefox') > -1) browser = 'Firefox';
            else if (ua.indexOf('Edge') > -1) browser = 'Edge';

            const deviceInfo = `
                <div class="ip-info-row">
                    <span class="ip-label">Type d'appareil</span>
                    <span class="ip-value">${deviceType}</span>
                </div>
                <div class="ip-info-row">
                    <span class="ip-label">Syst√®me</span>
                    <span class="ip-value">${os}</span>
                </div>
                <div class="ip-info-row">
                    <span class="ip-label">Navigateur</span>
                    <span class="ip-value">${browser}</span>
                </div>
                <div class="ip-info-row">
                    <span class="ip-label">Langue</span>
                    <span class="ip-value">${navigator.language}</span>
                </div>
                <div class="ip-info-row">
                    <span class="ip-label">√âcran</span>
                    <span class="ip-value">${window.screen.width}x${window.screen.height}</span>
                </div>
            `;

            document.getElementById('deviceInfo').innerHTML = deviceInfo;
        }

        // R√©cup√©rer l'IP publique
        async function getPublicIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                
                // R√©cup√©rer des infos suppl√©mentaires
                const geoResponse = await fetch(`https://ipapi.co/${data.ip}/json/`);
                const geoData = await geoResponse.json();

                const ipInfo = `
                    <div class="ip-info-row">
                        <span class="ip-label">Adresse IP</span>
                        <span class="ip-value">${data.ip}</span>
                    </div>
                    <div class="ip-info-row">
                        <span class="ip-label">Pays</span>
                        <span class="ip-value">${geoData.country_name || 'N/A'}</span>
                    </div>
                    <div class="ip-info-row">
                        <span class="ip-label">Ville</span>
                        <span class="ip-value">${geoData.city || 'N/A'}</span>
                    </div>
                    <div class="ip-info-row">
                        <span class="ip-label">FAI</span>
                        <span class="ip-value">${geoData.org || 'N/A'}</span>
                    </div>
                    <div class="ip-info-row">
                        <span class="ip-label">Timezone</span>
                        <span class="ip-value">${geoData.timezone || 'N/A'}</span>
                    </div>
                `;

                document.getElementById('myIpInfo').innerHTML = ipInfo;
            } catch (error) {
                document.getElementById('myIpInfo').innerHTML = `
                    <div class="alert-danger" style="padding: 10px; border-radius: 8px;">
                        ‚ùå Impossible de r√©cup√©rer l'IP
                    </div>
                `;
            }
        }

        // Simuler des statistiques
        function refreshStats() {
            document.getElementById('totalUsers').textContent = Math.floor(Math.random() * 1000) + 500;
            document.getElementById('verifiedUsers').textContent = Math.floor(Math.random() * 500) + 200;
            document.getElementById('bannedUsers').textContent = Math.floor(Math.random() * 50);
            document.getElementById('activeUsers').textContent = Math.floor(Math.random() * 300) + 100;
        }

        // Charger la liste des utilisateurs
        function loadUsers() {
            const usersList = document.getElementById('usersList');
            const mockUsers = [
                { id: 123456, name: 'User 1', username: 'user1', status: 'verified' },
                { id: 789012, name: 'User 2', username: 'user2', status: 'active' },
                { id: 345678, name: 'User 3', username: 'user3', status: 'banned' }
            ];

            let html = '';
            mockUsers.forEach(user => {
                const statusEmoji = user.status === 'verified' ? '‚úÖ' : user.status === 'banned' ? 'üö´' : 'üë§';
                html += `
                    <div class="user-item">
                        <div class="user-info-item">
                            <div class="user-name">${statusEmoji} ${user.name}</div>
                            <div class="user-id">@${user.username} ‚Ä¢ ID: ${user.id}</div>
                        </div>
                        <div class="user-actions">
                            <button class="btn btn-small" onclick="viewUserInfo(${user.id})">‚ÑπÔ∏è</button>
                            <button class="btn btn-small btn-secondary" onclick="banUserById(${user.id})">üö´</button>
                        </div>
                    </div>
                `;
            });

            usersList.innerHTML = html;
        }

        // Fonctions des boutons
        function openGrabify() {
            tg.openLink('https://grabify.link');
        }

        function openIPLogger() {
            tg.openLink('https://iplogger.org');
        }

        function openIPify() {
            tg.openLink('https://www.ipify.org');
        }

        function sendQuickBroadcast() {
            tg.showAlert('Utilisez /admin dans le bot pour envoyer un broadcast complet');
        }

        function generateInviteLink() {
            tg.showAlert('Utilisez /admin dans le bot pour g√©n√©rer un lien d\'invitation');
        }

        function exportUsers() {
            tg.showPopup({
                title: 'üì• Export en cours',
                message: 'Les donn√©es seront export√©es via le bot. V√©rifiez vos messages priv√©s.',
                buttons: [{type: 'ok'}]
            });
        }

        function searchUser() {
            const query = document.getElementById('searchUser').value;
            if (!query) {
                tg.showAlert('Entrez un ID ou username');
                return;
            }
            tg.showAlert(`Recherche de: ${query}\n\nUtilisez /info ${query} dans le bot pour voir les d√©tails`);
        }

        function previewBroadcast() {
            const message = document.getElementById('broadcastMessage').value;
            if (!message) {
                tg.showAlert('Entrez un message d\'abord');
                return;
            }
            tg.showPopup({
                title: 'üëÅÔ∏è Pr√©visualisation',
                message: message,
                buttons: [{type: 'ok'}]
            });
        }

        function confirmBroadcast() {
            const message = document.getElementById('broadcastMessage').value;
            if (!message) {
                tg.showAlert('Entrez un message d\'abord');
                return;
            }
            tg.showConfirm('Envoyer ce broadcast √† tous les utilisateurs ?', (confirmed) => {
                if (confirmed) {
                    tg.showAlert('Broadcast envoy√© ! V√©rifiez les r√©sultats dans le bot avec /admin');
                }
            });
        }

        function copyTemplate() {
            const template = document.querySelector('textarea[readonly]').value;
            navigator.clipboard.writeText(template);
            tg.showAlert('‚úÖ Template copi√© !');
        }

        function banUser() {
            tg.showAlert('Utilisez /ban <user_id> dans le bot');
        }

        function unbanUser() {
            tg.showAlert('Utilisez /unban <user_id> dans le bot');
        }

        function viewInfo() {
            tg.showAlert('Utilisez /info <user_id> dans le bot');
        }

        function viewStats() {
            tg.showAlert('Consultez les statistiques compl√®tes avec /admin dans le bot');
        }

        function clearCache() {
            tg.showConfirm('Vider le cache local ?', (confirmed) => {
                if (confirmed) {
                    localStorage.clear();
                    tg.showAlert('‚úÖ Cache vid√© !');
                }
            });
        }

        function openBotSettings() {
            tg.showAlert('Param√®tres disponibles via le bot avec /admin');
        }

        function reloadData() {
            refreshStats();
            loadUsers();
            detectDevice();
            getPublicIP();
            tg.showAlert('‚úÖ Donn√©es recharg√©es !');
        }

        function viewUserInfo(userId) {
            tg.showAlert(`Utilisez /info ${userId} dans le bot pour voir les d√©tails complets`);
        }

        function banUserById(userId) {
            tg.showConfirm(`Bannir l'utilisateur ${userId} ?`, (confirmed) => {
                if (confirmed) {
                    tg.showAlert(`Utilisez /ban ${userId} dans le bot`);
                }
            });
        }

        // Initialisation
        refreshStats();
        loadUsers();
        detectDevice();
        getPublicIP();

        // Bouton principal
        tg.MainButton.text = "Fermer";
        tg.MainButton.show();
        tg.MainButton.onClick(function() {
            tg.close();
        });

        // Rafra√Æchir les stats toutes les 30 secondes
        setInterval(refreshStats, 30000);
    </script>
</body>
</html>